{"code":"webpackJsonp([16],{T7AJ:function(t,e,o){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=o(\"WT6e\"),s=o(\"Xjw4\"),r=o(\"bfOx\"),n=o(\"NOoU\"),a=o(\"R12H\"),l=o(\"SEOj\"),d=o(\"D1Z2\"),c=o(\"ntJC\"),p=this&&this.__decorate||function(t,e,o,i){var s,r=arguments.length,n=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if(\"object\"==typeof Reflect&&\"function\"==typeof Reflect.decorate)n=Reflect.decorate(t,e,o,i);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(n=(r<3?s(n):r>3?s(e,o,n):s(e,o))||n);return r>3&&n&&Object.defineProperty(e,o,n),n},u=this&&this.__metadata||function(t,e){if(\"object\"==typeof Reflect&&\"function\"==typeof Reflect.metadata)return Reflect.metadata(t,e)},h=function(){function t(t,e,o,i,s){this.http=t,this.router=e,this.cookieStore=o,this.globalService=i,this.tododetail=s,this.state={tabs:{demo3:\"hr1\"}},this.projectDefault=[],this.todoList=[],this.todoLists=[],this.selects=[],this.uId=0,this.rollback_url=\"/to-do/todo-workbench\",this.publish_todo_title=[],this.workbench_project_id=[],this.workbench_template_id=[],this.project_id=0,this.dropTemplateId=\"\",this.todo_type=\"workbench\",this.isEdit=0,this.is_show_detail=\"\";this.globalService.navEventEmitter.emit('{\"title\":\"\\u6211\\u7684\\u5de5\\u4f5c\\u53f0\",\"url\":\"/to-do/todo-workbench\",\"class_\":\"active\"}'),this.uId=this.cookieStore.getCookie(\"uid\"),this.isHaveTemplate(),window.scrollTo(0,0)}return t.prototype.ngOnInit=function(){},t.prototype.showDetail=function(t,e,o){var i=this;this.tododetail.showDetail(t,e,o),setTimeout(function(){i.is_show_detail=i.tododetail.todo_info.result.template_id},600)},t.prototype.getData=function(t){this.isEdit=t,1==this.isEdit&&this.isHaveTemplate()},t.prototype.isHaveTemplate=function(){var t=this,e=this.globalService.getDomain()+\"/api/v1/isHaveTemplate?uid=\"+this.uId+\"&sid=\"+this.cookieStore.getCookie(\"sid\");this.http.get(e).map(function(t){return t.json()}).subscribe(function(e){console.log(e),202==e.status?(t.cookieStore.removeAll(t.rollback_url),t.router.navigate([\"/auth/login\"])):200==e.status&&(t.project_id=e.result.project_id,t.getTodoDefault(t.project_id))})},t.prototype.getTodoDefault=function(t){var e=this,o=this.globalService.getDomain()+\"/api/v1/getTodoList?todo_type=\"+this.todo_type+\"_add&project_id=\"+t+\"&uid=\"+this.uId+\"&sid=\"+this.cookieStore.getCookie(\"sid\");this.http.get(o).map(function(t){return t.json()}).subscribe(function(t){e.todoList=t,202==e.todoList.status&&(e.cookieStore.removeAll(e.rollback_url),e.router.navigate([\"/auth/login\"])),e.selects=[];for(var o=0,i=e.todoList.result.template_list;o<i.length;o++){var s=i[o];e.selects[s.key]=!1,e.publish_todo_title[s.key]=\"\",e.workbench_project_id[s.key]=\"\",e.workbench_template_id[s.key]=\"\"}})},t.prototype.getTodoInfo=function(t){var e=this,o=t.target.value;if(0!=o){var i=this.globalService.getDomain()+\"/api/v1/getTodoList?todo_type=\"+this.todo_type+\"&project_id=\"+o+\"&uid=\"+this.uId+\"&sid=\"+this.cookieStore.getCookie(\"sid\");this.http.get(i).map(function(t){return t.json()}).subscribe(function(t){e.todoLists=t,202==e.todoLists.status&&(e.cookieStore.removeAll(e.rollback_url),e.router.navigate([\"/auth/login\"]))})}},t.prototype.submitTodo=function(t,e){var o=this;if(\"\"==this.publish_todo_title[e].trim())return alert(\"\\u8bf7\\u586b\\u5199\\u4efb\\u52a1\\u6807\\u9898\\uff01\"),!1;this.http.post(this.globalService.getDomain()+\"/api/v1/addTodo\",{project_id:t,template_id:e,todo_title:this.publish_todo_title[e],uid:this.uId,todo_type:this.todo_type+\"_add\",workbench_project_id:this.workbench_project_id[e],workbench_template_id:this.workbench_template_id[e],sid:this.cookieStore.getCookie(\"sid\")}).subscribe(function(t){var e=JSON.parse(t._body);if(200==e.status){o.todoList=e,o.selects=[];for(var i=0,s=o.todoList.result.template_list;i<s.length;i++){var r=s[i];o.selects[r.key]=!1,o.publish_todo_title[r.key]=\"\",o.workbench_project_id[r.key]=\"\",o.workbench_template_id[r.key]=\"\"}}else 202==e.status?(alert(e.msg),o.cookieStore.removeAll(o.rollback_url),o.router.navigate([\"/auth/login\"])):201==e.status&&alert(e.msg)})},t.prototype.showAddTodo=function(t){this.selects[t]=!this.selects[t],console.log(\"this.projectDefault\"),console.log(this.projectDefault),0==this.projectDefault.length&&this.getProjectDefault(1)},t.prototype.onDragList_=function(t){var e=this;if(\"\"==this.dropTemplateId.trim())return alert(\"\\u8bf7\\u62d6\\u62fd\\u8fdb\\u6846\\u5185\\u518d\\u653e\\u5f00\\u9f20\\u6807\\uff01\"),!1;this.http.post(this.globalService.getDomain()+\"/api/v1/todoDnd\",{project_id:this.project_id,dragTodoId:t,dropWorkBenchTemplateId:this.dropTemplateId,uid:this.uId,todo_type:this.todo_type+\"_add\",sid:this.cookieStore.getCookie(\"sid\")}).subscribe(function(t){var o=JSON.parse(t._body);if(200==o.status){e.todoList=o,e.selects=[];for(var i=0,s=e.todoList.result.template_list;i<s.length;i++){var r=s[i];e.selects[r.key]=!1,e.publish_todo_title[r.key]=\"\",e.workbench_project_id[r.key]=\"\",e.workbench_template_id[r.key]=\"\"}}else 202==o.status?(alert(o.msg),e.cookieStore.removeAll(e.rollback_url),e.router.navigate([\"/auth/login\"])):201==o.status&&alert(o.msg)})},t.prototype.onListDrop_=function(t){this.dropTemplateId=t},t.prototype.getProjectDefault=function(t){var e=this,o=this.globalService.getDomain()+\"/api/v1/getWorkbenchDefault?page=\"+t+\"&uid=\"+this.uId+\"&sid=\"+this.cookieStore.getCookie(\"sid\");this.http.get(o).map(function(t){return t.json()}).subscribe(function(t){e.projectDefault=t,console.log(\"this.projectDefault:-----\"),console.log(e.projectDefault),202==e.projectDefault.status&&(e.cookieStore.removeAll(e.rollback_url),e.router.navigate([\"/auth/login\"]))})},t.prototype.editStatus=function(t,e,o,i){var s=this;t.stopPropagation();var r=\"\\u60a8\\u786e\\u5b9a\\u6b64\\u4efb\\u52a1\\u5df2\\u5b8c\\u6210\\uff1f\";1==e&&(r=\"\\u60a8\\u786e\\u5b9a\\u6062\\u590d\\u6b64\\u4efb\\u52a1\\u72b6\\u6001\\u4e3a\\u672a\\u5b8c\\u6210\\uff1f\"),confirm(r)&&this.http.post(this.globalService.getDomain()+\"/api/v1/addTodo\",{todo_id:o,project_id:i,todo_status:e,is_list:1,is_send_message:\"true\",todo_type:this.todo_type+\"_add\",uid:this.cookieStore.getCookie(\"uid\"),sid:this.cookieStore.getCookie(\"sid\")}).subscribe(function(t){var e=JSON.parse(t._body);if(200==e.status){s.todoList=e,s.selects=[];for(var o=0,i=s.todoList.result.template_list;o<i.length;o++){var r=i[o];s.selects[r.key]=!1,s.publish_todo_title[r.key]=\"\",s.workbench_project_id[r.key]=\"\",s.workbench_template_id[r.key]=\"\"}}else 202==e.status?(alert(e.msg),s.cookieStore.removeAll(s.rollback_url),s.router.navigate([\"/auth/login\"])):201==e.status&&alert(e.msg)})},t=p([Object(d.a)(),Object(i.Component)({selector:\"app-todo-workbench\",template:o(\"opxE\"),styles:[\"\\n        div.scroll-list {\\n            overflow: auto;\\n            max-height: 70vh;\\n        }\\n        .drag-over {\\n            border: #ff525b dashed 2px !important;\\n        }\\n        .drag-hint {\\n            border: #ffc100 dashed 2px !important;\\n            /*transition: all .2s ease-in-out;*/\\n            /*transform: scale(1.05);*/\\n        }\\n        .drag-target-border {\\n            border: #00bfff dashed 2px !important;\\n        }\\n    \"]}),u(\"design:paramtypes\",[n.b,r.c,c.a,a.a,l.a])],t)}(),g=[{path:\"\",component:h}],_=r.d.forChild(g),b=o(\"pvSQ\"),f=o(\"JOm+\"),v=o(\"7DMc\"),k=o(\"aoYM\"),m=o(\"qq2c\");o.d(e,\"TodoWorkbenchModule\",function(){return j});var y=this&&this.__decorate||function(t,e,o,i){var s,r=arguments.length,n=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if(\"object\"==typeof Reflect&&\"function\"==typeof Reflect.decorate)n=Reflect.decorate(t,e,o,i);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(n=(r<3?s(n):r>3?s(e,o,n):s(e,o))||n);return r>3&&n&&Object.defineProperty(e,o,n),n},j=function(){function t(){}return t=y([Object(i.NgModule)({imports:[s.CommonModule,b.a,f.a,v.f,m.a,_,k.NgDragDropModule.forRoot()],declarations:[h]})],t)}()},opxE:function(t,e){t.exports='\\r\\n<div id=\"content\">\\r\\n  <sa-widgets-grid>\\r\\n    <div class=\"row\">\\r\\n      <article class=\"col-sm-12 \">\\r\\n        <sa-widget [editbutton]=\"false\" [deletebutton]=\"false\" >\\r\\n          <header>\\r\\n            <span class=\"widget-icon\"> <i class=\"fa fa-inbox\"></i> </span>\\r\\n            <h2>\\u6211\\u7684\\u5de5\\u4f5c\\u53f0</h2>\\r\\n          </header>\\r\\n          <div>\\r\\n            \\x3c!--\\u5c0f\\u90e8\\u4ef6\\u5185\\u5bb9--\\x3e\\r\\n            <div class=\"widget-body no-padding\">\\r\\n              <div  class=\"ng-scope\">\\r\\n                <div class=\"entries_panel js-sortable layout_content_main_tasks ng-scope wt-scroll entries_panel_cross\"  >\\r\\n                  <div  class=\"entries_panel_sortarea ui-sortable margin-bottom-40\">\\r\\n                    <div class=\"entry ng-scope\" *ngFor=\"let tl of todoList?.result?.template_list;let ind = index;\" droppable [dropScope]=\"\\'\\'+tl.key\" [dragOverClass]=\"\\'drag-target-border\\'\"\\r\\n                         [dragHintClass]=\"\\'drag-hint\\'\" (onDrop)=\"onListDrop_(tl.key)\" >\\r\\n                      <div  class=\"entry_header ui-sortable-handle\">\\r\\n                        <i  class=\"wtfont wtf-entryhover ng-scope\"></i>\\r\\n                        <div  class=\"entry_header_title\">\\r\\n                          <h2 >\\r\\n                            <a><span  class=\"ng-binding ng-scope\">{{tl.info}}</span></a>\\r\\n                          </h2>\\r\\n                        </div>\\r\\n                      </div>\\r\\n                      <div  class=\"entry-task-panel wt-scroll entries_panel_height\" >\\r\\n\\r\\n                        <div  class=\"entry-tasks js-sortable ui-sortable\" *ngFor=\"let tl1 of tl.todo_list;let indtl=index;\">\\r\\n                          <div (click)=\"showDetail(tl1.todo_id,tl.info,1);\" class=\"right_click_trigger slide-trigger js-popbox false task task_style task- task-selected  drag-handle\"  draggable [dragScope]=\"tl.d\" [dragClass]=\"\\'drag-over\\'\" [dragData]=\"tl1\" (onDragEnd)=\"onDragList_(tl1.todo_id)\">\\x3c!--,tl1.project_id--\\x3e\\r\\n                            <div [ngClass]=\"{\\'entry-task-main\\':true,\\'task-completed-style\\':tl1.todo_status==2}\">\\r\\n                              <a class=\"entry-task-check ng-scope\" *ngIf=\"tl1.todo_status != 2\" (click)=\"editStatus($event,2,tl1.todo_id,todoList?.result?.project_id)\">\\r\\n                                <i class=\"fa fa-square-o\"></i>\\r\\n                              </a>\\r\\n                              <a class=\"entry-task-check ng-scope\" *ngIf=\"tl1.todo_status == 2\" (click)=\"editStatus($event,1,tl1.todo_id,todoList?.result?.project_id)\">\\r\\n                                <i class=\"fa fa-check-square\"></i>\\r\\n                              </a>\\r\\n                              <a  class=\"entry-task-title ng-binding\">{{tl1.todo_title}}</a>\\r\\n                            </div>\\r\\n                            <div  class=\"task-badges task-height\">\\r\\n                              <span class=\"task-badge fa fa-inbox\" title=\"{{tl1.project_title}}\">{{tl1.project_title}}</span>\\r\\n                            </div>\\r\\n                          </div>\\r\\n                        </div>\\r\\n\\r\\n                        \\x3c!--\\u65b0\\u5efa\\u4efb\\u52a1\\u53d1\\u5e03\\u6846--\\x3e\\r\\n                        <div class=\"entry-add-bottom-composer entry-task-composer ng-isolate-scope\" *ngIf=\"selects[tl.key]\">\\r\\n                          <div class=\"composer-body\" >\\r\\n                            <div class=\"entry-task-labels\">\\r\\n                            </div>\\r\\n                            <textarea rows=\"2\" class=\"form-control help-block\" placeholder=\"\\u8bf7\\u8f93\\u5165\\u4efb\\u52a1\\u6807\\u9898\" [ngModelOptions]=\"{standalone: true}\" [(ngModel)]=\"publish_todo_title[tl.key]\"></textarea>\\r\\n                            <form  class=\"smart-form\">\\r\\n\\r\\n                              <div class=\"form-group col col-lg-12 col-md-12 col-sm-12 col-xs-12\">\\r\\n                                <div class=\"margin-lr30\" >\\r\\n                                  <section class=\"col col-6\">\\r\\n                                    <label  class=\"select form-control border-0\">\\r\\n                                      <select [(ngModel)]=\"workbench_project_id[tl.key]\" [ngModelOptions]=\"{standalone: true}\" (change)=\"getTodoInfo($event)\" class=\"ng-valid ng-touched ng-dirty\">\\r\\n                                        <option value=\"0\" >--\\u8bf7\\u9009\\u62e9\\u9879\\u76ee\\u540d--</option>\\r\\n                                        <option *ngFor=\"let pd of projectDefault?.result?.categoryList\" [disabled]=\"(pd.is_parent == 1) ? \\'disabled\\' : false\" [ngStyle]=\"{\\'font-weight\\':((pd.is_parent == 1) ? \\'bold\\' : \\'normal\\'),\\'color\\':((pd.is_parent == 1) ? \\'black\\' : \\' rgb(64, 64, 64)\\')}\" value=\"{{pd.project_id}}\">{{pd.project_title}}</option>\\r\\n                                      </select> <i ></i>\\r\\n                                    </label>\\r\\n                                  </section>\\r\\n                                  <section class=\"col col-6\">\\r\\n                                    <label class=\"select\">\\r\\n                                      <select [(ngModel)]=\"workbench_template_id[tl.key]\" [ngModelOptions]=\"{standalone: true}\">\\r\\n                                        <option value=\"0\" >--\\u8bf7\\u9009\\u62e9\\u4efb\\u52a1\\u540d--</option>\\r\\n                                        <option *ngFor=\"let tt of todoLists?.result?.template_list\" value=\"{{tt.key}}\">{{tt.info}}</option>\\r\\n                                      </select> <i></i> </label>\\r\\n                                  </section>\\r\\n                                </div>\\r\\n                              </div>\\r\\n                            </form>\\r\\n\\r\\n                            <div class=\"composer-body-footer\">\\r\\n                              <div class=\"task-badges\" >\\r\\n                              </div>\\r\\n                            </div>\\r\\n                          </div>\\r\\n                          <div class=\"composer-footer\">\\r\\n                            <button  class=\"btn btn-success btn--big confirm mr-10 ng-binding\" (click)=\"submitTodo(todoList?.result?.project_id,tl.key)\">\\u4fdd&nbsp;&nbsp;\\u5b58</button>\\r\\n                            <button  class=\"btn btn-link btn-cancel ng-binding\" (click)=\"showAddTodo(tl.key)\">\\u53d6&nbsp;&nbsp;\\u6d88</button>\\r\\n                          </div>\\r\\n                        </div>\\r\\n\\r\\n                      </div>\\r\\n\\r\\n                      <div  class=\"entry-task-footer ng-scope\" *ngIf=\" ! selects[tl.key]\">\\r\\n                        <a  class=\"js-add-task-composer ng-binding ng-scope\" (click)=\"showAddTodo(tl.key)\">\\r\\n                          <i  class=\"fa fa-plus-circle\"></i> \\u65b0\\u5efa\\u4efb\\u52a1\\r\\n                        </a>\\r\\n                      </div>\\r\\n                    </div>\\r\\n                  </div>\\r\\n                </div>\\r\\n              </div>\\r\\n\\r\\n            </div>\\r\\n          </div>\\r\\n        </sa-widget>\\r\\n      </article>\\r\\n    </div>\\r\\n  </sa-widgets-grid>\\r\\n</div>\\r\\n\\r\\n<app-todo-mission-detail (isEdit)=\"getData($event)\" [todoList]=\"todoList\" [selects]=\"selects\" [is_show_detail]=\"is_show_detail\" *ngIf=\"is_show_detail\"></app-todo-mission-detail>\\r\\n'}});","extractedComments":[]}