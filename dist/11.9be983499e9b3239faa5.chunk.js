webpackJsonp([11],{XUwe:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=s("WT6e"),i=s("Xjw4"),r=s("bfOx"),n=s("R12H"),l=s("ntJC"),a=s("NOoU"),c=this&&this.__decorate||function(e,t,s,o){var i,r=arguments.length,n=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,s,o);else for(var l=e.length-1;l>=0;l--)(i=e[l])&&(n=(r<3?i(n):r>3?i(t,s,n):i(t,s))||n);return r>3&&n&&Object.defineProperty(t,s,n),n},p=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},d=function(){function e(e,t,s,o){this.http=e,this.router=t,this.cookieStore=s,this.globalService=o,this.datePickerConfig={locale:"zh-CN",format:"YYYY-MM-DD",enableMonthSelector:!0,showMultipleYearsNavigation:!0},this.evection_list=[],this.approve_users=[],this.approve_user=[],this.follower_user=[],this.remove_user_ids=[],this.approval_or_copy="",this.is_show_detail="",this.is_show_details="",this.select_type="",this.show_big_pic="",this.imgList=[],this.day="",this.reason="",this.uid=0,this.cid=0,this.type=2,this.domain_url="",this.url=this.globalService.getDomain(),this.rollback_url="",this.permissions=[],this.uid=this.cookieStore.getCookie("uid"),this.cid=this.cookieStore.getCookie("cid"),this.domain_url=this.globalService.getDomain(),this.evection_list=[{address:"",start:"",end:""}]}return e.prototype.ngOnInit=function(){var e=this;this.globalService.getMenuInfo(),setTimeout(function(){e.menu_id=e.globalService.getMenuId(),e.rollback_url=e.globalService.getMenuUrl(),e.permissions=e.globalService.getPermissions()},this.globalService.getMenuPermissionDelayTime())},e.prototype.isPermission=function(e,t){var s=e+"_"+t;return""==t&&(s=e),this.cookieStore.in_array(s,this.permissions)},e.prototype.joinEvection=function(){this.evection_list.push({address:"",start:"",end:""})},e.prototype.deleteEvection=function(e){this.evection_list.splice(e,1)},e.prototype.onSubmit=function(e){var t=this;if(""==this.day.trim())return alert("\u8bf7\u586b\u5199\u5929\u6570\uff01"),!1;if(""==this.reason.trim())return alert("\u8bf7\u586b\u5199\u51fa\u5dee\u4e8b\u7531\uff01"),!1;var s=[];this.approve_user.forEach(function(e,t,o){s.push(e.id)});var o=[];this.follower_user.forEach(function(e,t,s){o.push(e.id)}),this.http.post(this.globalService.getDomain()+"/api/v1/addApproval",{approval_start_date:this.evection_list[0].start,approval_end_date:this.evection_list[this.evection_list.length-1].end,day:this.day,reason:this.reason,info:JSON.stringify(this.evection_list),approval_img:JSON.stringify(this.imgList),approval_assign:JSON.stringify(s),approval_copy_person:JSON.stringify(o),approval_type:this.type,u_id:this.cookieStore.getCookie("uid"),sid:this.cookieStore.getCookie("sid")}).subscribe(function(s){var o=JSON.parse(s._body);alert(o.msg),200==o.status?1==e?t.router.navigate(["/process/approval-process/0"]):t.clear_():202==o.status&&(t.cookieStore.removeAll(t.rollback_url),t.router.navigate(["/auth/login"]))})},e.prototype.clear_=function(){this.evection_list=[{address:"",start:"",end:""}],this.day="",this.reason="",this.approve_users=[],this.approve_user=[],this.follower_user=[],this.imgList=[]},e.prototype.showSelectFileDiv=function(){this.select_type="file"},e.prototype.getSelectTypes=function(){this.select_type=""},e.prototype.getImgLists=function(e){this.imgList=JSON.parse(e)},e.prototype.showBigPic=function(e){this.select_type="bigPic",this.show_big_pic=e},e.prototype.showDetail=function(e){var t=this;this.approval_or_copy=e,setTimeout(function(){t.is_show_detail="1"},500)},e.prototype.getData=function(e){"assign"==this.approval_or_copy?this.approve_user=JSON.parse(e):"follower"==this.approval_or_copy&&(this.follower_user=JSON.parse(e))},e.prototype.getShowStatus=function(e){this.is_show_detail=e},e.prototype.removeUser=function(e,t){this.remove_user_ids.push(e);var s=[];"assign"==t?(this.approve_user.forEach(function(t,o,i){t.id!=e&&s.push(t)}),this.approve_user=s):"follower"==t&&(this.follower_user.forEach(function(t,o,i){t.id!=e&&s.push(t)}),this.follower_user=s)},e=c([Object(o.Component)({selector:"app-initiate-evection",template:s("orFq"),encapsulation:o.ViewEncapsulation.None,styles:[s("htqL")]}),p("design:paramtypes",[a.b,r.c,l.a,n.a])],e)}(),u=[{path:"",component:d}],h=r.d.forChild(u),g=s("pvSQ"),f=s("JOm+"),v=s("jfyD"),m=s("SSMX"),b=s("50Tv"),_=s("1pPv"),y=s("VPG1");s.d(t,"InitiateEvectionModule",function(){return w});var x=this&&this.__decorate||function(e,t,s,o){var i,r=arguments.length,n=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,s,o);else for(var l=e.length-1;l>=0;l--)(i=e[l])&&(n=(r<3?i(n):r>3?i(t,s,n):i(t,s))||n);return r>3&&n&&Object.defineProperty(t,s,n),n},w=function(){function e(){}return e=x([Object(o.NgModule)({imports:[i.CommonModule,g.a,f.a,h,m.a,b.a,y.a,_.a],declarations:[d],providers:[v.CookieService,l.a]})],e)}()},htqL:function(e,t){e.exports='@charset "UTF-8";\n/**\r\n\u4e0a\u4f20\u56fe\u7247\r\n */\n/*\u56fe\u7247\u4e0a\u4f20\u6309\u94ae*/\n.c-file-upload {\n  display: block;\n  overflow: hidden;\n  position: relative; }\n.c-file-upload [type=file] {\n    cursor: pointer;\n    display: block;\n    filter: alpha(opacity=0);\n    min-height: 100%;\n    min-width: 100%;\n    opacity: 0;\n    position: absolute;\n    right: 0;\n    text-align: right;\n    top: 0; }\n/*\u767d\u8272*/\n/*\u5185\u5bb9*/\n.c-content-inner {\n  background-color: #ffffff;\n  border: 0px;\n  border-radius: 1px;\n  -webkit-box-shadow: 1px 2px 6px rgba(0, 0, 0, 0.03);\n  box-shadow: 1px 2px 6px rgba(0, 0, 0, 0.03);\n  -moz-box-shadow: 1px 2px 6px rgba(0, 0, 0, 0.03);\n  padding: 15px; }\n.c-mt15 {\n  margin-top: 15px; }\n'},orFq:function(e,t){e.exports='<div id="content">\r\n  <sa-widgets-grid>\r\n    <div class="row">\r\n      <article class="col-sm-12 ">\r\n        <sa-widget [editbutton]="false" [deletebutton]="false" >\r\n          <header >\r\n            <span class="widget-icon"> <i class="fa fa-edit"></i> </span>\r\n            <h2 >\u51fa\u5dee</h2>\r\n          </header>\r\n          <div>\r\n            \x3c!--\u5c0f\u90e8\u4ef6\u5185\u5bb9--\x3e\r\n            <div class="widget-body no-padding">\r\n              <form id="smart-form-register" class="smart-form">\r\n                <fieldset *ngFor="let xc of evection_list;let ind_xc = index;">\r\n                  <legend>\u884c\u7a0b\u660e\u7ec6({{ind_xc+1}})</legend>\r\n                  <input type="hidden" name="">\r\n                  <div class="form-group col col-lg-4 col-md-4 col-sm-6 col-xs-12 ">\r\n                    <section>\r\n                      <label class="label txt-color-blue">\u51fa\u5dee\u5730\u70b9<span class="asterisk-color">*</span></label>\r\n                      <label class="input">\r\n                        <input  type="text" placeholder="\u5982\uff1a\u5317\u4eac\u3001\u4e0a\u6d77\u3001\u56db\u5ddd\u3001\u676d\u5dde\uff08\u5fc5\u586b\uff09" name="xc.address" [ngModelOptions]="{standalone: true}" [(ngModel)]="xc.address">\r\n                      </label>\r\n                    </section>\r\n                  </div>\r\n                  <div class="form-group col col-lg-4 col-md-4 col-sm-6 col-xs-12 ">\r\n                    <section >\r\n                      <label class="label txt-color-blue">\u5f00\u59cb\u65e5\u671f<span class="asterisk-color">*</span></label>\r\n                      <label  class="input">\r\n                        <input name="xc.start" [ngModelOptions]="{standalone: true}" [(ngModel)]="xc.start" value="{{xc.start}}" [dpDayPicker]="datePickerConfig" [theme]="\'dp-material\'" [mode]="\'day\'" placeholder="\u9009\u62e9\u65e5\u671f\uff08\u5fc5\u586b\uff09" class="form-control ng-binding expire-text-soon"/>\r\n                      </label>\r\n                    </section>\r\n                  </div>\r\n                  <div class="form-group col col-lg-4 col-md-4 col-sm-6 col-xs-12 ">\r\n                    <section >\r\n                      <label class="label txt-color-blue">\u7ed3\u675f\u65e5\u671f<span class="asterisk-color">*</span></label>\r\n                      <label  class="input">\r\n                        <input name="xc.end" [ngModelOptions]="{standalone: true}" [(ngModel)]="xc.end" value="{{xc.end}}" [dpDayPicker]="datePickerConfig" [theme]="\'dp-material\'" [mode]="\'day\'" placeholder="\u9009\u62e9\u65e5\u671f\uff08\u5fc5\u586b\uff09" class="form-control ng-binding expire-text-soon"/>\r\n                      </label>\r\n                    </section>\r\n                  </div>\r\n                  <div class="form-group col col-lg-12 col-md-12 col-sm-12 col-xs-12 mb-20 text-center" *ngIf="ind_xc != 0">\r\n                    <button class="btn btn-default btn-xs " (click)="deleteEvection(ind_xc)" >\r\n                      <span class="hidden-mobile">\u5220\u9664\u884c\u7a0b\u660e\u7ec6({{ind_xc + 1}})</span>\r\n                    </button>\r\n                  </div>\r\n                </fieldset>\r\n                <fieldset>\r\n                  <div class="form-group col col-lg-12 col-md-12 col-sm-12 col-xs-12 mb-20 text-center">\r\n                    <button class="btn btn-save btn-xs " (click)="joinEvection()">\r\n                      <i class="fa fa-plus"></i> <span class="hidden-mobile">\u6dfb\u52a0\u884c\u7a0b\u660e\u7ec6</span>\r\n                    </button>\r\n                  </div>\r\n                  <div class="form-group col col-lg-12 col-md-12 col-sm-12 col-xs-12 ">\r\n                    <section>\r\n                      <label class="label txt-color-blue">\u51fa\u5dee\u5929\u6570<span class="asterisk-color">*</span></label>\r\n                      <label class="input">\r\n                        <input  type="text" placeholder="\u8bf7\u8f93\u5165\u51fa\u5dee\u5929\u6570\uff08\u5fc5\u586b\uff09" name="day" [(ngModel)]="day">\r\n                      </label>\r\n                    </section>\r\n                  </div>\r\n                  <div class="form-group col col-lg-12 col-md-12 col-sm-12 col-xs-12 ">\r\n                    <section>\r\n                      <label class="label txt-color-blue">\u51fa\u5dee\u4e8b\u7531<span class="asterisk-color">*</span></label>\r\n                      <label class="textarea textarea-resizable">\r\n                        <textarea class="custom-scroll" rows="4" name="reason" [(ngModel)]="reason" placeholder="\u8bf7\u8f93\u5165\u51fa\u5dee\u4e8b\u7531\uff08\u5fc5\u586b\uff09"></textarea>\r\n                      </label>\r\n                    </section>\r\n                  </div>\r\n                  <div class="form-group col col-lg-12 col-md-12 col-sm-12 col-xs-12 ">\r\n                    <div class="label ">\u56fe\u7247<a class="txt-color-blue pd-10" (click)="showSelectFileDiv()">\u6dfb\u52a0\u56fe\u7247</a><span class="txt-color-blueLight pd-10">(\u6700\u591a\u53ef\u4ee5\u9009\u62e910\u5f20)</span></div>\r\n                    <div  class="picture mb-20">\r\n                      <div  class="picture-list" *ngFor="let img of imgList;let ind = index;" >\r\n                        <a  class="fa fa-times-circle picture-a" style="display:block;" (click)="removeImg(ind)"></a>\r\n                        <img width="90px" height="90px" src="{{url}}{{img}}" (click)="showBigPic(url+img)">\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                  <div class="form-group col col-lg-12 col-md-12 col-sm-12 col-xs-12 mb-20">\r\n                    <div class="label ">\u9644\u4ef6<a class="txt-color-blue pd-10" >\u6dfb\u52a0\u9644\u4ef6</a></div>\r\n                  </div>\r\n                  <div class="form-group col col-lg-12 col-md-12 col-sm-12 col-xs-12 mb-20">\r\n                    <div class="label ">\u5ba1\u6279\u4eba<a class="txt-color-blue pd-10" (click)="showDetail(\'assign\')">\u6dfb\u52a0\u5ba1\u6279\u4eba</a></div>\r\n                    <ul  class="avatars" *ngIf="approve_user">\r\n                      <li *ngFor="let su of approve_user;let ind = index;">\r\n                        <a class="fa fa-times-circle picture-a" style="display:block;" (click)="removeUser(su.id,\'assign\')"></a>\r\n                        <a class="portrait-size" title="{{su.u_username}}">\r\n                          {{su.u_username}}\r\n                        </a>\r\n                        <div class="approval-arrow" *ngIf="ind < approve_user.length && ind != 0" >\r\n                          <img src="assets/img/icon/arrow.png" >\r\n                        </div>\r\n                      </li>\r\n                    </ul>\r\n                  </div>\r\n                  <div class="form-group col col-lg-12 col-md-12 col-sm-12 col-xs-12 mb-20">\r\n                    <div class="label ">\u6284\u9001\u4eba<a class="txt-color-blue pd-10" (click)="showDetail(\'follower\')">\u6dfb\u52a0\u6284\u9001\u4eba</a><span class="txt-color-blueLight pd-10">(\u5ba1\u6279\u901a\u8fc7\u540e\uff0c\u901a\u77e5\u6284\u9001\u4eba)</span></div>\r\n                    <ul  class="avatars" *ngIf="follower_user">\r\n                      <li *ngFor="let su1 of follower_user;let ind1 = index;">\r\n                        <a class="fa fa-times-circle picture-a" style="display:block;" (click)="removeUser(su1.id,\'follower\')"></a>\r\n                        <a class="portrait-size" title="{{su1.u_username}}">\r\n                          {{su1.u_username}}\r\n                        </a>\r\n                      </li>\r\n                    </ul>\r\n                  </div>\r\n                </fieldset>\r\n                <footer>\r\n                  <button type="button" class="btn btn-default" >\r\n                    \u8fd4\u56de\r\n                  </button>\r\n                  <button class="btn btn-success" type="button" (click)="onSubmit(2)">\u63d0\u4ea4\u5e76\u65b0\u589e</button>\r\n                  <button  type="submit" class="btn btn-primary" (click)="onSubmit(1)">\r\n                    \u63d0\u4ea4\r\n                  </button>\r\n                </footer>\r\n              </form>\r\n            </div>\r\n          </div>\r\n        </sa-widget>\r\n      </article>\r\n    </div>\r\n  </sa-widgets-grid>\r\n</div>\r\n\r\n\x3c!--\u9009\u62e9\u5ba1\u6279\u4eba\u548c\u6284\u9001\u4eba--\x3e\r\n<app-select-user (approve_users)="getData($event)" [is_show_detail]="is_show_detail" (is_show_details)="getShowStatus($event)" [approval_or_copy]="approval_or_copy" *ngIf="is_show_detail"></app-select-user>\r\n\x3c!--\u9009\u4e0d\u7528\u88c1\u526a\u7684\u56fe\u7247--\x3e\r\n<app-select-file [select_type]="select_type" [imgList]="imgList" (select_types)="getSelectTypes()" (imgLists)="getImgLists($event)"></app-select-file>\r\n\x3c!--\u67e5\u770b\u5927\u56fe--\x3e\r\n<app-big-pic [select_type]="select_type" [show_big_pic]="show_big_pic" (select_types)="getSelectTypes()"></app-big-pic>\r\n'}});