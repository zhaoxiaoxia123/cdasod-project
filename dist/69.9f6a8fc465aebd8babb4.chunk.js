webpackJsonp([69],{kYV5:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=o("WT6e"),i=o("Xjw4"),c=o("bfOx"),n=o("D1Z2"),s=o("NOoU"),l=o("R12H"),a=o("ntJC"),p=o("Exih"),d=this&&this.__decorate||function(t,e,o,r){var i,c=arguments.length,n=c<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(n=(c<3?i(n):c>3?i(e,o,n):i(e,o))||n);return c>3&&n&&Object.defineProperty(e,o,n),n},u=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},g=function(){function t(t,e,o,r){this.http=t,this.router=e,this.cookieStore=o,this.globalService=r,this.projectList=[],this.projectDefault=[],this.projectInfo=[],this.categoryList=[],this.isShowButton=0,this.edit_project_id=0,this.project_owner=0,this.project_publicity=0,this.project_template=!1,this.uId=0,this.rollback_url="/forms/todo-projects",this.globalService.getMenuInfo(),this.uId=this.cookieStore.getCookie("uid"),this.getProjectList("1"),this.getProjectDefault(),window.scrollTo(0,0)}return t.prototype.ngOnInit=function(){},t.prototype.getProjectDefault=function(){var t=this,e=this.globalService.getDomain()+"/api/v1/getProjectDefault?sid="+this.cookieStore.getCookie("sid");this.http.get(e).map(function(t){return t.json()}).subscribe(function(e){t.projectDefault=e,202==t.projectDefault.status&&(t.cookieStore.removeAll(t.rollback_url),t.router.navigate(["/auth/login"]))})},t.prototype.showOrHide=function(t){this.isShowButton=t},t.prototype.deleteProjectById=function(t,e){var o=this;t.stopPropagation(),confirm("\u60a8\u786e\u5b9a\u8981\u5220\u9664\u8be5\u9879\u76ee\uff0c\u4ee5\u53ca\u8be5\u9879\u76ee\u4e0b\u7684\u6240\u6709\u4efb\u52a1\u4fe1\u606f\u5417\uff1f")&&this.http.delete(this.globalService.getDomain()+"/api/v1/deleteProjectById?project_id="+e+"&type=id&sid="+this.cookieStore.getCookie("sid")).map(function(t){return t.json()}).subscribe(function(t){o.projectList=t,202==o.projectList.status&&(alert(o.projectList.msg),o.cookieStore.removeAll(o.rollback_url),o.router.navigate(["/auth/login"]))})},t.prototype.getProjectList=function(t){var e=this,o=this.globalService.getDomain()+"/api/v1/getProjectList?page="+t+"&uId="+this.uId+"&sid="+this.cookieStore.getCookie("sid");this.http.get(o).map(function(t){return t.json()}).subscribe(function(t){e.projectList=t,202==e.projectList.status&&(e.cookieStore.removeAll(e.rollback_url),e.router.navigate(["/auth/login"]))})},t.prototype.showAddProject=function(t,e,o){var r=this;if(this.project_owner=e,this.edit_project_id=o,0!=o){t.stopPropagation();var i=this.globalService.getDomain()+"/api/v1/getProjectInfo?project_id="+o;this.http.get(i).map(function(t){return t.json()}).subscribe(function(t){r.projectInfo=t,202==r.projectInfo.status&&(r.cookieStore.removeAll(r.rollback_url),r.router.navigate(["/auth/login"])),r.project_owner=r.projectInfo.result.project_owner,r.project_title=r.projectInfo.result.project_title,r.project_content=r.projectInfo.result.project_content,r.project_publicity=r.projectInfo.result.project_publicity,r.project_template=null!=r.projectInfo.result.project_template&&""!=r.projectInfo.result.project_template})}0!=this.project_owner&&this.changeCategory(this.project_owner,2)},t.prototype.isCommon=function(t,e,o){var r=this;t.stopPropagation();var i="\u786e\u5b9a\u6807\u8bb0\u4e3a\u5e38\u7528\u9879\u76ee\u5417?";2==o&&(i="\u786e\u5b9a\u8981\u53d6\u6d88\u6807\u8bb0\u8be5\u9879\u76ee\u5417\uff1f"),confirm(i)&&this.http.post(this.globalService.getDomain()+"/api/v1/addCommonProject",{project_id:e,project_status:o,uId:this.uId,sid:this.cookieStore.getCookie("sid")}).subscribe(function(t){var e=JSON.parse(t._body);201==e.status?alert(e.msg):202==e.status&&(alert(e.msg),r.cookieStore.removeAll(r.rollback_url),r.router.navigate(["/auth/login"])),r.projectList=e})},t.prototype.onSubmit=function(){var t=this;if(""==this.project_title.trim())return alert("\u8bf7\u8f93\u5165\u9879\u76ee\u6807\u9898\uff01"),!1;this.http.post(this.globalService.getDomain()+"/api/v1/addProject",{edit_project_id:this.edit_project_id,project_owner:this.project_owner,project_title:this.project_title,project_content:this.project_content,project_publicity:this.project_publicity,project_template:this.project_template,u_id:this.cookieStore.getCookie("uid"),sid:this.cookieStore.getCookie("sid")}).subscribe(function(e){var o=JSON.parse(e._body);200==o.status?(t.router.navigate(["/forms/todo-mission/"+o.result.last_project_id+"_0"]),t.edit_project_id=0,t.project_owner=0,t.project_title="",t.project_content="",t.project_publicity=0,t.projectList=o.result.projectList):202==o.status&&(alert(o.msg),t.cookieStore.removeAll(t.rollback_url),t.router.navigate(["/auth/login"])),t.lgModal.hide()})},t.prototype.changeCategory=function(t,e){var o=this,r=0;r=1==e?t.target.value:t,this.http.get(this.globalService.getDomain()+"/api/v1/getProjectPublicity?category_id="+r+"&sid="+this.cookieStore.getCookie("sid")).map(function(t){return t.json()}).subscribe(function(t){o.categoryList=t,202==o.categoryList.status&&(alert(o.categoryList.msg),o.cookieStore.removeAll(o.rollback_url),o.router.navigate(["/auth/login"]))})},t.prototype.closeSubmit=function(){this.edit_project_id=0,this.project_owner=0,this.project_title="",this.project_content="",this.project_publicity=0,this.lgModal.hide()},d([Object(r.ViewChild)("lgModal"),u("design:type",p.d)],t.prototype,"lgModal",void 0),t=d([Object(n.a)(),Object(r.Component)({selector:"app-todo-projects",template:o("rZ3W")}),u("design:paramtypes",[s.b,c.c,a.a,l.a])],t)}(),j=[{path:"",component:g}],h=c.d.forChild(j),f=o("7DMc"),b=o("pvSQ"),m=o("JOm+");o.d(e,"TodoProjectsModule",function(){return _});var v=this&&this.__decorate||function(t,e,o,r){var i,c=arguments.length,n=c<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(n=(c<3?i(n):c>3?i(e,o,n):i(e,o))||n);return c>3&&n&&Object.defineProperty(e,o,n),n},_=function(){function t(){}return t=v([Object(r.NgModule)({imports:[i.CommonModule,f.f,b.a,m.a,h],declarations:[g]})],t)}()},rZ3W:function(t,e){t.exports='\x3c!--\u4e3b\u8981\u5185\u5bb9--\x3e\r\n<div id="content">\r\n  <sa-widgets-grid>\r\n    <div class="row">\r\n      <article class="col-sm-12 ">\r\n        <sa-widget [editbutton]="false" [deletebutton]="false" >\r\n          <header>\r\n            <span class="widget-icon"> <i class="fa fa-inbox"></i> </span>\r\n            <h2>\u9879\u76ee</h2>\r\n          </header>\r\n          <div>\r\n            \x3c!--\u5c0f\u90e8\u4ef6\u5185\u5bb9--\x3e\r\n            <div class="widget-body no-padding">\r\n              <div class="project-grid-panel">\r\n                <div class="form-group ">\r\n                  <a class="btn btn-success btn-sm" (click)="showAddProject($event,0,0);lgModal.show();">\r\n                    <span class="glyphicon glyphicon-plus"></span>\u65b0\u5efa\u9879\u76ee</a>\r\n                </div>\r\n                <div class="row margin-bottom-10">\r\n                  <div class="projects-panel-header ">\r\n                    <i class="fa fa-star padding-left-5"></i>\r\n                    \u5e38\u7528\u9879\u76ee\r\n                    <span class="txt-color-red padding-left-10">{{projectList?.result?.commonArrayCount}}</span>\r\n                  </div>\r\n                  <div class="project-grid ">\r\n                    <div class="project-item" (mouseover)="showOrHide(ca.project_id)" (mouseleave)="showOrHide(0)" [routerLink]="[\'/forms/todo-mission\',ca.project_id+\'_0\']" *ngFor="let ca of projectList?.result?.commonArray">\r\n                      <a class="star" (click)="isCommon($event,ca.project_id,ca.project_status);">\r\n                        <i class="fa fa-star txt-color-yellowMing"></i> </a>\r\n                      <a class="center ">\r\n                        <i class="fa-fw fa fa-inbox text-blove"></i>\r\n                        <h4 class="">{{ca.project_title}}</h4></a>\r\n                      <a *ngIf="isShowButton == ca.project_id" class="add-project" (click)="showAddProject($event,ca.project_owner,ca.project_id);lgModal.show();">\r\n                        <i class="glyphicon glyphicon-pencil" style="font-size:12px;"></i>\r\n                      </a>\r\n                      <a *ngIf="isShowButton == ca.project_id" class="delete-project" (click)="deleteProjectById($event,ca.project_id);">\r\n                        <i class="fa fa-minus-circle"></i>\r\n                      </a>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n                <div class="row margin-bottom-10" *ngFor="let cl of projectList?.result?.categoryList;">\r\n                  <div class="projects-panel-header">\r\n                    <span>\r\n                      <i class="fa fa-sitemap padding-left-5"></i>&nbsp;&nbsp;{{cl.category_desc}}\r\n                    </span>\r\n                    <span class="txt-color-red padding-left-10">\r\n                      {{cl.project_count}}\r\n                    </span>\r\n                  </div>\r\n                  <div class="project-grid ">\r\n                    <div class="project-item ">\r\n                      <a class="center "  (click)="showAddProject($event,cl.category_id,0);lgModal.show();">\r\n                        <i class="fa-fw fa fa-inbox text-blove"></i>\r\n                        <h4 class="">\u53d1\u8d77\u9879\u76ee</h4></a>\r\n                    </div>\r\n                    <div class="project-item" (mouseover)="showOrHide(pl.project_id)" (mouseleave)="showOrHide(0)" [routerLink]="[\'/forms/todo-mission\',pl.project_id+\'_0\']" *ngFor="let pl of cl.project_list">\r\n                      <a class="star" (click)="isCommon($event,pl.project_id,pl.project_status);">\r\n                        <i class="fa fa-star-o" *ngIf="pl.project_status == 1"></i>\r\n                        <i class="fa fa-star txt-color-yellowMing" *ngIf="pl.project_status == 2"></i></a>\r\n                      <a class="center">\r\n                        <i class="fa-fw fa fa-inbox text-blove"></i>\r\n                        <h4 class="">{{pl.project_title}}</h4></a>\r\n                      <a *ngIf="isShowButton == pl.project_id" class="add-project" (click)="showAddProject($event,cl.category_id,pl.project_id);lgModal.show();">\r\n                        <i class="glyphicon glyphicon-pencil" style="font-size:12px;"></i>\r\n                      </a>\r\n                      <a *ngIf="isShowButton == pl.project_id" class="delete-project" (click)="deleteProjectById($event,pl.project_id);">\r\n                        <i class="fa fa-minus-circle"></i>\r\n                      </a>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </sa-widget>\r\n      </article>\r\n    </div>\r\n  </sa-widgets-grid>\r\n\r\n  <div bsModal #lgModal="bs-modal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel"\r\n       aria-hidden="true">\r\n    <div class="modal-dialog">\r\n      <div class="modal-content">\r\n        <div class="modal-header">\r\n          \x3c!-- \u5173\u95ed\u6309\u94ae --\x3e\r\n          <button type="button" class="close" (click)="closeSubmit()" aria-label="Close"> \xd7 </button>\r\n          \x3c!-- \u6807\u9898 --\x3e\r\n          <h3 class="modal-title txt-color-blue" data-ng-bind=\'results.title\' *ngIf="edit_project_id == 0"><i class="fa-fw fa fa-plus"></i>\u65b0\u5efa\u9879\u76ee</h3>\r\n          <h3 class="modal-title txt-color-blue" data-ng-bind=\'results.title\' *ngIf="edit_project_id != 0"><i class="glyphicon glyphicon-pencil"></i>\u4fee\u6539\u9879\u76ee</h3>\r\n        </div>\r\n        <div class="modal-body">\r\n          <form   class="smart-form ">\r\n            <fieldset>\r\n              <div class="form-group col col-lg-12 col-md-12 col-sm-12 col-xs-12">\r\n                <section>\r\n                  <label class="label">\u9879\u76ee\u6240\u5c5e\uff1a</label>\r\n                  <label class="select">\r\n                    <select class="input-sm" name="project_owner" [(ngModel)]="project_owner" (change)="changeCategory($event,1)">\r\n                      <option value="0" disabled="disabled" style="color:#ccc;">\u8bf7\u9009\u62e9\u6240\u6709\u8005\uff1a</option>\r\n                      <option *ngFor="let c1 of projectDefault?.result?.categoryList1" [selected]="projectInfo.result?.project_owner == c1.category_id" value="{{c1.category_id}}">{{c1.category_desc}}</option>\r\n                    </select> <i></i> </label>\r\n                </section>\r\n              </div>\r\n\r\n              <div class="form-group col col-lg-12 col-md-12 col-sm-12 col-xs-12">\r\n                <section>\r\n                  <label class="label">\u9879\u76ee\u4fe1\u606f\uff1a</label>\r\n                  <label class="input">\r\n                    <input type="text" placeholder="\u8bf7\u8f93\u5165\u9879\u76ee\u540d\u79f0" minlength="1" maxlength="30" name="project_title" [(ngModel)]="project_title" >\r\n                  </label>\r\n                </section>\r\n              </div>\r\n              <div class="form-group col col-lg-12 col-md-12 col-sm-12 col-xs-12">\r\n                <section>\r\n                  <label class="textarea textarea-resizable">\r\n                    <textarea class="custom-scroll" rows="2" minlength="1" maxlength="30" name="project_content" [(ngModel)]="project_content" placeholder="\u9879\u76ee\u63cf\u8ff0(\u53ef\u9009)"></textarea>\r\n                  </label>\r\n                </section>\r\n              </div>\r\n              <div class="form-group col col-lg-12 col-md-12 col-sm-12 col-xs-12">\r\n                <section>\r\n                  <label class="label">\u9879\u76ee\u516c\u5f00\u6027\uff1a</label>\r\n                  <label class="select">\r\n                    <select class="input-sm" name="project_publicity" [(ngModel)]="project_publicity">\r\n                      <option value="0" disabled="disabled" style="color:#ccc;">\u8bf7\u9009\u62e9\u516c\u5f00\u6027\uff1a</option>\r\n                      <option *ngFor="let c2 of categoryList?.result" value="{{c2.category_id}}" [selected]="projectInfo.result?.project_publicity == c2.category_id" >{{c2.category_desc}}</option>\r\n                    </select> <i></i> </label>\r\n                </section>\r\n              </div>\r\n              <div class="form-group col col-lg-12 col-md-12 col-sm-12 col-xs-12 ">\r\n                <section>\r\n                  <label class="label">\u9009\u62e9\u6a21\u677f</label>\r\n\r\n                  <div class="inline-group">\r\n                    <label class="checkbox state-disabled">\r\n                      <input type="checkbox" [checked]="project_template" name="project_template" [(ngModel)]="project_template" >\r\n                      <i></i>\u901a\u7528\u6a21\u677f</label>\r\n                  </div>\r\n                </section>\r\n              </div>\r\n            </fieldset>\r\n          </form>\r\n        </div>\r\n        <div class="modal-footer">\r\n          <button type="button" class="btn btn-primary" (click)="onSubmit();">\u786e\u5b9a</button>\r\n          <button type="button" class="btn btn-default" (click)="closeSubmit()">\u5173\u95ed</button>\r\n        </div>\r\n      </div>\x3c!-- /.modal-content --\x3e\r\n    </div>\x3c!-- /.modal --\x3e\r\n  </div>\r\n\r\n\r\n</div>'}});